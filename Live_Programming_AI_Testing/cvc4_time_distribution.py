import time
import os


def removeFunctionsFromGrammar(functionsToKeep, path_to_file):
    with open(path_to_file) as oldfile, open('tester.sl', 'w') as newfile:
        writeAll = False
        newfile.write("(set-logic SLIA)\n\n\n(synth-fun f ((name String)) String\n((Start String (ntString))\n")
        for num, line in enumerate(oldfile):
            if num > 7:
                if writeAll:
                    newfile.write(line)
                elif "(ntBool Bool (true false" in line:
                    newfile.write(line)
                    writeAll = True
                elif any(function_ in line for function_ in functionsToKeep) or (line.count('(') != 1 and line.count(')\n') != 1):
                    newfile.write(line)
                elif line.count(')') >= 3 and line.count('(') == 1:
                    newfile.write('))')

def timeSynthesis(timeout, file):
    startTime = time.time()
    os.system("timeout " + str(timeout) + "s cvc4  "+ file)
    return time.time() - startTime

total_times = {}
possibleFunctions = ["str.++", "str.replace", "str.at", "int.to.str", "str.substr", "(+", "(-", "str.len",
                         "str.to.int", "str.indexof"]
results = {'bikes-long-repeat.sl': [3.468726873397827, 1.8042051792144775, 1.0131988525390625, 1.6817028522491455, 4.717201232910156, 1.9948022365570068, 2.263880968093872, 10.00948691368103, 1.8436219692230225, 1.5873651504516602], 'bikes-long.sl': [1.2858679294586182, 1.3147480487823486, 0.8448920249938965, 1.6281168460845947, 4.405287027359009, 1.8515739440917969, 2.0423741340637207, 10.008169889450073, 1.7988409996032715, 1.5426888465881348], 'bikes.sl': [0.8846526145935059, 1.0124390125274658, 0.6602833271026611, 1.1622838973999023, 2.5008671283721924, 1.3804199695587158, 1.3864381313323975, 10.010979890823364, 1.3659288883209229, 1.1865780353546143], 'bikes_small.sl': [10.013418912887573, 0.7814269065856934, 0.5234658718109131, 1.1012861728668213, 1.3359830379486084, 1.0748522281646729, 1.1477649211883545, 9.221174955368042, 1.146423101425171, 1.126413106918335], 'dr-name-long-repeat.sl': [10.011175870895386, 0.3583958148956299, 0.47293591499328613, 0.7232162952423096, 10.0085289478302, 0.7432661056518555, 0.7754960060119629, 0.7489099502563477, 0.7760131359100342, 10.010162115097046], 'dr-name-long.sl': [10.010106086730957, 0.7146801948547363, 0.6742348670959473, 0.7544858455657959, 10.010934114456177, 0.7116899490356445, 0.7612490653991699, 0.7552342414855957, 0.757051944732666, 10.010523080825806], 'dr-name.sl': [10.010788917541504, 0.06981182098388672, 0.057704925537109375, 0.0627901554107666, 9.675556898117065, 0.06496787071228027, 0.06749820709228516, 0.06522417068481445, 0.08178567886352539, 10.00819993019104], 'dr-name_small.sl': [10.009315013885498, 0.06812763214111328, 0.051915884017944336, 0.06350207328796387, 7.9216578006744385, 0.08400607109069824, 0.06374597549438477, 0.07040619850158691, 0.07184219360351562, 10.009526014328003], 'firstname-long-repeat.sl': [0.19335579872131348, 0.20110797882080078, 0.17887473106384277, 0.15293264389038086, 10.008989095687866, 0.19790005683898926, 0.1975879669189453, 0.19596481323242188, 0.20972204208374023, 10.011181116104126], 'firstname-long.sl': [0.18887090682983398, 0.19089579582214355, 0.17342710494995117, 0.160628080368042, 10.01127028465271, 0.1974167823791504, 0.1968519687652588, 0.19667673110961914, 0.20041799545288086, 10.011189222335815], 'firstname.sl': [0.0748448371887207, 0.058912038803100586, 0.04950284957885742, 0.057531118392944336, 10.01180911064148, 0.05686593055725098, 0.051136016845703125, 0.04793882369995117, 0.04746222496032715, 10.013006687164307], 'firstname_small.sl': [0.05080819129943848, 0.047122955322265625, 0.03571891784667969, 0.04448509216308594, 5.352084159851074, 0.04763507843017578, 0.04992794990539551, 0.045606136322021484, 0.04559779167175293, 10.013396978378296], 'initials-long-repeat.sl': [10.009320974349976, 1.8610260486602783, 10.007364988327026, 2.36948823928833, 1.5272221565246582, 3.8762660026550293, 3.221688985824585, 3.11742901802063, 3.0142741203308105, 10.007192134857178], 'initials-long.sl': [10.01448392868042, 10.007298946380615, 10.012027978897095, 10.008544921875, 10.011638164520264, 10.013911962509155, 10.01494812965393, 10.016517162322998, 10.008502006530762, 10.010395765304565], 'initials.sl': [10.007045984268188, 0.23966217041015625, 1.0100460052490234, 0.2459728717803955, 0.17491626739501953, 0.3656299114227295, 0.3566141128540039, 0.35492491722106934, 0.3518822193145752, 10.007761001586914], 'initials_small.sl': [10.011735916137695, 0.14026093482971191, 0.8536920547485352, 0.30779075622558594, 0.08646082878112793, 0.30268001556396484, 0.24711918830871582, 0.2261803150177002, 0.2560250759124756, 10.009099960327148], 'lastname-long-repeat.sl': [10.011256217956543, 10.009474992752075, 10.009314060211182, 10.014508724212646, 10.013129949569702, 10.012335062026978, 10.018217086791992, 10.012784957885742, 10.011728286743164, 10.011120080947876], 'lastname-long.sl': [10.009383916854858, 10.008358001708984, 10.014322996139526, 10.01854419708252, 10.008334159851074, 10.020673036575317, 10.016014099121094, 10.011674880981445, 10.014535188674927, 10.011899709701538], 'lastname.sl': [2.91153883934021, 1.461364984512329, 1.8597886562347412, 2.10518479347229, 10.015996217727661, 2.127635955810547, 2.0245792865753174, 10.010565996170044, 2.402874708175659, 10.007935047149658], 'lastname_small.sl': [1.4922690391540527, 1.0804822444915771, 1.805751085281372, 2.1460390090942383, 10.008491039276123, 1.669795036315918, 1.6097216606140137, 10.006127834320068, 1.9233899116516113, 10.010387897491455], 'phone-1-long-repeat.sl': [0.5162627696990967, 0.5184497833251953, 0.5945918560028076, 0.5320301055908203, 0.2781026363372803, 0.5208349227905273, 0.5152182579040527, 0.5194981098175049, 0.5168731212615967, 0.5192101001739502], 'phone-1-long.sl': [0.5034260749816895, 0.5080502033233643, 0.5406591892242432, 0.502446174621582, 0.24704194068908691, 0.5242431163787842, 0.504993200302124, 0.503169059753418, 0.5043656826019287, 0.519136905670166], 'phone-1.sl': [0.05191612243652344, 0.04973435401916504, 0.04830598831176758, 0.05096912384033203, 0.050920963287353516, 0.06417202949523926, 0.05282878875732422, 0.05003190040588379, 0.06172990798950195, 0.06397604942321777], 'phone-10-long-repeat.sl': [10.007548809051514, 10.006662845611572, 10.01288914680481, 10.008416891098022, 10.007261991500854, 10.015687227249146, 10.010059118270874, 10.01400899887085, 10.011184215545654, 10.010013103485107], 'phone-10-long.sl': [10.007629156112671, 10.009972095489502, 10.011637926101685, 10.01171088218689, 10.010821104049683, 10.008440732955933, 10.01209306716919, 10.012422800064087, 10.012621879577637, 10.011082172393799], 'phone-10.sl': [10.015403985977173, 10.008952140808105, 10.01500678062439, 10.012032985687256, 5.951714992523193, 10.008883953094482, 10.012031078338623, 10.01476001739502, 10.01002287864685, 10.01016879081726], 'phone-10_short.sl': [10.008234024047852, 5.176625728607178, 10.007763862609863, 9.997355699539185, 2.635549783706665, 10.012936115264893, 10.010642051696777, 10.01553988456726, 9.021144151687622, 10.007994174957275], 'phone-1_short.sl': [0.06424403190612793, 0.06028294563293457, 0.055397987365722656, 0.06182503700256348, 0.03634905815124512, 0.059142112731933594, 0.060973167419433594, 0.0686802864074707, 0.08084821701049805, 0.06900215148925781], 'phone-2-long-repeat.sl': [3.2946178913116455, 0.8541660308837891, 3.9749019145965576, 0.9438230991363525, 0.3607628345489502, 10.01102900505066, 0.8937208652496338, 0.9862971305847168, 0.9921817779541016, 0.8959810733795166], 'phone-2-long.sl': [3.4020941257476807, 0.906242847442627, 3.1961898803710938, 0.7119269371032715, 0.3128662109375, 8.284891128540039, 0.7841010093688965, 0.8144283294677734, 0.8096499443054199, 0.7772328853607178], 'phone-2.sl': [0.2615628242492676, 0.07030773162841797, 0.1735832691192627, 0.07429099082946777, 0.0463869571685791, 0.6853888034820557, 0.06686997413635254, 0.06596565246582031, 0.07150793075561523, 0.07689094543457031], 'phone-2_short.sl': [0.20619893074035645, 0.06238412857055664, 0.16753077507019043, 0.0679318904876709, 0.04186391830444336, 0.46489691734313965, 0.062499284744262695, 0.0622100830078125, 0.06388592720031738, 0.07194399833679199], 'phone-3-long-repeat.sl': [10.008611917495728, 1.0310389995574951, 2.7025961875915527, 1.054898738861084, 0.6270968914031982, 2.8849129676818848, 1.1401479244232178, 1.275169849395752, 1.1981098651885986, 1.1775760650634766], 'phone-3-long.sl': [10.011577129364014, 0.8901679515838623, 2.31182599067688, 0.9553899765014648, 0.553048849105835, 2.4262728691101074, 1.1000208854675293, 1.0509896278381348, 1.0821609497070312, 1.0691120624542236], 'phone-3.sl': [10.012983083724976, 0.13771510124206543, 0.1816871166229248, 0.12039613723754883, 0.0768430233001709, 0.24709200859069824, 0.13289189338684082, 0.1384420394897461, 0.13631796836853027, 0.12887096405029297], 'phone-3_short.sl': [10.008051872253418, 0.1166532039642334, 0.16935396194458008, 0.11904406547546387, 0.05928516387939453, 0.22942304611206055, 0.11120271682739258, 0.11618423461914062, 0.11781716346740723, 0.11646199226379395], 'phone-4-long-repeat.sl': [10.01117992401123, 0.8919432163238525, 3.376217842102051, 0.9738900661468506, 0.5124690532684326, 10.010508060455322, 1.066195011138916, 1.0204150676727295, 1.0416390895843506, 1.0375957489013672], 'phone-4-long.sl': [10.009734153747559, 0.8665380477905273, 3.2361857891082764, 0.858508825302124, 0.4930391311645508, 10.010986089706421, 0.9679112434387207, 0.9919836521148682, 0.9913568496704102, 0.9714081287384033], 'phone-4.sl': [1.603470802307129, 0.09327411651611328, 0.21068382263183594, 0.08782219886779785, 0.062341928482055664, 1.972499132156372, 0.10288405418395996, 0.0989370346069336, 0.12571287155151367, 0.09441208839416504], 'phone-4_short.sl': [1.5422759056091309, 0.07873201370239258, 0.19289398193359375, 0.08674001693725586, 0.05194973945617676, 1.9158062934875488, 0.0885000228881836, 0.08637380599975586, 0.09475016593933105, 0.09169411659240723], 'phone-5-long-repeat.sl': [10.011089086532593, 10.016791105270386, 10.012875080108643, 10.01044511795044, 10.014046907424927, 10.009212970733643, 10.009155035018921, 10.011384963989258, 10.009538650512695, 10.011536836624146], 'phone-5-long.sl': [10.01151704788208, 10.009241104125977, 10.009151935577393, 10.01024603843689, 10.010987997055054, 10.007460832595825, 10.010658979415894, 10.016130924224854, 10.010717868804932, 10.008161783218384], 'phone-5.sl': [10.012124061584473, 2.5472309589385986, 9.650008916854858, 3.9936461448669434, 2.151175022125244, 4.7439751625061035, 5.397485256195068, 5.827181816101074, 4.876924753189087, 6.389296293258667], 'phone-5_short.sl': [10.008015871047974, 1.723494291305542, 6.481879949569702, 4.2071778774261475, 1.2662999629974365, 3.389688014984131, 4.452758073806763, 3.7090837955474854, 3.881920099258423, 7.023200988769531], 'phone-6-long-repeat.sl': [10.00908637046814, 10.009536027908325, 10.00708794593811, 10.015986919403076, 10.012522220611572, 10.01100206375122, 10.01993989944458, 10.015779972076416, 10.015837907791138, 10.028922080993652], 'phone-6-long.sl': [10.01308298110962, 10.014694213867188, 10.014281272888184, 10.013088941574097, 10.006906747817993, 10.020347833633423, 10.009552001953125, 10.007986783981323, 10.015306949615479, 10.011208772659302], 'phone-6.sl': [10.010509967803955, 2.6402158737182617, 10.008019924163818, 6.875146865844727, 3.7210071086883545, 6.312168836593628, 7.442446231842041, 6.458772897720337, 6.60506272315979, 10.008064031600952], 'phone-6_short.sl': [10.008585929870605, 2.5016701221466064, 10.007812976837158, 6.943304061889648, 2.0035340785980225, 7.062970876693726, 5.769603252410889, 6.594135046005249, 7.046066999435425, 10.008757829666138], 'phone-7-long-repeat.sl': [10.009052753448486, 10.008450984954834, 10.010876893997192, 10.010183095932007, 10.013707876205444, 10.012831926345825, 10.007479906082153, 10.019172191619873, 10.007997751235962, 10.012928009033203], 'phone-7-long.sl': [10.01347303390503, 10.012372970581055, 10.01262903213501, 10.009659767150879, 10.008653163909912, 10.021805047988892, 10.015758991241455, 10.016828298568726, 10.010105848312378, 10.011182069778442], 'phone-7.sl': [10.011451721191406, 2.314718008041382, 10.00855016708374, 3.4181220531463623, 1.8240749835968018, 6.03909969329834, 4.727726221084595, 4.681946039199829, 4.781810760498047, 10.00899887084961], 'phone-7_short.sl': [10.021518230438232, 1.3895947933197021, 10.00702714920044, 5.59342885017395, 1.3750050067901611, 9.310824155807495, 5.463274002075195, 5.102909088134766, 4.040415048599243, 10.01108694076538], 'phone-8-long-repeat.sl': [10.01960802078247, 10.0120849609375, 10.009892225265503, 10.00770878791809, 10.014301776885986, 10.013738870620728, 10.006839990615845, 10.011351108551025, 10.011898279190063, 10.010469198226929], 'phone-8-long.sl': [10.008492946624756, 10.010584115982056, 10.006561040878296, 10.01383090019226, 10.010432004928589, 10.01730489730835, 10.01136302947998, 10.011654138565063, 10.009037971496582, 10.011772871017456], 'phone-8.sl': [10.010681867599487, 2.2837750911712646, 10.00842022895813, 3.674078941345215, 2.0203652381896973, 5.8021650314331055, 10.014861106872559, 10.010453939437866, 4.966096878051758, 2.892591953277588], 'phone-8_short.sl': [8.056181907653809, 0.6924111843109131, 5.822802305221558, 1.6951758861541748, 0.727388858795166, 1.531735897064209, 10.015789031982422, 10.011933088302612, 1.7563300132751465, 1.3605008125305176], 'phone-9-long-repeat.sl': [10.007504940032959, 10.018875122070312, 10.016542911529541, 10.009662866592407, 10.008413076400757, 10.006518840789795, 10.018218994140625, 10.017045974731445, 10.015739679336548, 10.01161503791809], 'phone-9-long.sl': [10.01387619972229, 10.01830506324768, 10.008657932281494, 10.00757884979248, 10.017497777938843, 10.00861406326294, 10.006718158721924, 10.009335994720459, 10.007314920425415, 10.011126041412354], 'phone-9.sl': [10.006561040878296, 10.011232852935791, 10.011038780212402, 4.1659698486328125, 2.331061840057373, 10.017051935195923, 10.009853839874268, 10.012500047683716, 5.204540252685547, 10.007088899612427], 'phone-9_short.sl': [10.012809991836548, 1.474470853805542, 10.010852813720703, 5.037697076797485, 1.059391975402832, 6.235320806503296, 10.006148099899292, 10.010709047317505, 4.971539258956909, 10.008475065231323], 'phone-long-repeat.sl': [0.19779300689697266, 0.1718888282775879, 0.14892077445983887, 0.16932034492492676, 0.2089221477508545, 0.17188310623168945, 0.15964889526367188, 0.15283608436584473, 0.16969799995422363, 0.15379881858825684], 'phone-long.sl': [0.1889798641204834, 0.14528107643127441, 0.15347814559936523, 0.13638687133789062, 0.15680289268493652, 0.14716315269470215, 0.15366768836975098, 0.1490166187286377, 0.16402292251586914, 0.13936400413513184], 'phone.sl': [0.03242611885070801, 0.0331728458404541, 0.03863811492919922, 0.0355830192565918, 0.03493523597717285, 0.033785104751586914, 0.03089284896850586, 0.03525400161743164, 0.049307823181152344, 0.04250979423522949], 'phone_short.sl': [0.033272743225097656, 0.03052973747253418, 0.02863287925720215, 0.036444902420043945, 0.04012584686279297, 0.045401811599731445, 0.036451101303100586, 0.03133416175842285, 0.030883073806762695, 0.03581380844116211]}
print(len(results))
preTimeTotal = 242.22162556648254
# for i in preTimes.values():
#     preTimeTotal += i[0]
# print(preTimeTotal)
best_time = 0
for x in results.values():
    best_time += min(x)
print(preTimeTotal-best_time)
total_distribution = [preTimeTotal-sum(x) for x in zip(*results.values())]
print(total_distribution)



# for filename, _ in files.items():
#     times = [0 for i in range(10)]
#     for j, func in enumerate(possibleFunctions):
#         removeFunctionsFromGrammar([f for f in possibleFunctions if f != func], "/Users/kairotieremorton/Downloads/PBE_Strings_Track/"+filename)
#         times[j] = timeSynthesis(10, "/Users/kairotieremorton/Documents/Code/Random\ Python\ Code/AI/Supervised\ Learning/Live\ Programming\ Yale\ Project/Live_Programming_AI_Testing/tester.sl")
#     total_times[filename] = times
#
# print(total_times)


